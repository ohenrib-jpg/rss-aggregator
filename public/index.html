<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agr√©gateur RSS Th√©matique + IA V.2.3</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Styles additionnels pour le header am√©lior√© */
        .header-main {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .header-title h1 {
            margin: 0 0 8px 0;
            font-size: 2rem;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header-subtitle {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 0.9rem;
            opacity: 0.9;
            flex-wrap: wrap;
        }

        .author {
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
        }

        .version {
            background: rgba(255,255,255,0.15);
            padding: 4px 8px;
            border-radius: 6px;
            font-family: monospace;
        }

        .header-tagline {
            font-size: 1rem;
            opacity: 0.9;
            margin-top: 8px;
            line-height: 1.4;
        }

        /* Demo Banner */
        .demo-banner {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 1px solid #ffeaa7;
            border-left: 4px solid #fdcb6e;
            padding: 16px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .demo-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .demo-content {
            flex: 1;
        }

        .demo-title {
            font-weight: 700;
            font-size: 1rem;
            color: #2d3436;
            margin-bottom: 6px;
        }

        .demo-text {
            font-size: 0.9rem;
            color: #636e72;
            line-height: 1.4;
            margin-bottom: 8px;
        }

        .demo-api-info {
            font-size: 0.85rem;
            color: #0984e3;
        }

        .demo-api-info a {
            color: #0984e3;
            text-decoration: none;
            font-weight: 600;
        }

        /* Export Bar */
        .export-bar {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .export-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .export-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .export-btn.json {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .export-btn.csv {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        }

        .export-btn.stats {
            background: linear-gradient(135deg, #06b6d4, #0891b2);
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .metric-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        /* Tab system */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .tab-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            overflow: hidden;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
            overflow-x: auto;
        }

        .tab {
            padding: 15px 20px;
            cursor: pointer;
            white-space: nowrap;
            font-weight: 500;
            color: #64748b;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .tab:hover {
            background: #e9ecef;
            color: #1e293b;
        }

        .tab.active {
            color: #2563eb;
            border-bottom-color: #2563eb;
            background: white;
        }

        .tab-content {
            display: none;
            padding: 20px;
        }

        .tab-content.active {
            display: block;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .card.full-width {
            grid-column: 1 / -1;
        }

        .card h3 {
            margin-bottom: 15px;
            font-size: 1.1rem;
            color: #1e293b;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #64748b;
            font-style: italic;
        }

        /* Charts */
        canvas {
            max-height: 350px;
        }

        /* Theme selector */
        .theme-selector {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .theme-checkboxes {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }

        .theme-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .theme-checkbox:hover {
            background: #e9ecef;
        }

        .theme-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
        }

        .theme-name {
            flex: 1;
            font-size: 0.9rem;
        }

        .theme-count {
            font-size: 0.8rem;
            color: #64748b;
        }

        .control-btn {
            background: #64748b;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .control-btn:hover {
            background: #475569;
        }

        .chart-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        /* Articles list */
        .article-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .article-card h4 {
            margin-bottom: 8px;
        }

        .article-card .meta {
            font-size: 0.85rem;
            color: #64748b;
            margin-bottom: 8px;
        }

        .themes .tag {
            display: inline-block;
            padding: 4px 8px;
            margin: 2px;
            background: #e0e7ff;
            border-radius: 4px;
            font-size: 0.75rem;
        }

        /* Top themes list */
        .top-themes {
            list-style: none;
            padding: 0;
        }

        .top-themes li {
            padding: 8px;
            border-bottom: 1px solid #e9ecef;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 12px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .close {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #64748b;
        }

        .close:hover {
            color: #1e293b;
        }

        @media (max-width: 768px) {
            .header-title h1 {
                font-size: 1.5rem;
            }

            .dashboard {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <header>
        <div class="header-main">
            <div class="header-title">
                <h1>üìä Agr√©gateur RSS Th√©matique</h1>
                <div class="header-subtitle">
                    <span class="author">Olivier Henri B.</span>
                    <span class="version">V.2.3</span>
                </div>
            </div>
            <div class="header-tagline">
                Analyse de flux RSS par th√®mes personnalis√©s - D√©tection avanc√©e des tendances + IA
            </div>
        </div>

        <div class="demo-banner">
            <div class="demo-icon">üöÄ</div>
            <div class="demo-content">
                <div class="demo-title">Application de d√©monstration</div>
                <div class="demo-text">
                    Avec √† pr√©sent la possibilit√© de stocker jusqu'√† 1Go de donn√©es (Merci √† Render!). 
                    Attention : cela reste un serveur de test et de pr√©sentation, il se r√©initialise automatiquement 
                    lorsque les quotas allou√©s sont atteints.
                </div>
                <div class="demo-api-info">
                    Testez la fonction IA avec une cl√© API gratuite sur 
                    <a href="https://platform.openai.com/api-keys" target="_blank" rel="noopener noreferrer">OpenAI</a>
                </div>
            </div>
        </div>
    </header>

    <div id="messageContainer"></div>

    <div class="status-bar">
        <div class="last-update" id="lastUpdate">Chargement...</div>
        <div class="refresh-controls">
            <div class="auto-refresh-indicator">
                <span class="blink">üîÑ</span> Auto-actualisation
            </div>
            <button class="refresh" onclick="app.manualRefresh()" id="refreshBtn">üîÑ G√©n√©rer</button>
        </div>
    </div>

    <div class="export-bar">
        <div class="export-controls">
            <button class="export-btn json" onclick="app.exportData('json')">üì• Export JSON</button>
            <button class="export-btn csv" onclick="app.exportData('csv')">üì• Export CSV</button>
            <button class="export-btn stats" onclick="app.showLearningStats()">üìä Stats Apprentissage</button>
        </div>
    </div>

    <div class="stats-grid" id="statsGrid">
        <div class="loading">Chargement des donn√©es...</div>
    </div>

    <div class="tab-container">
        <div class="tabs">
            <div class="tab active" onclick="showTab('analysis', event)">üìà Analyse</div>
            <div class="tab" onclick="showTab('trends', event)">üìä Tendances</div>
            <div class="tab" onclick="showTab('metrics', event)">üéØ M√©triques</div>
            <div class="tab" onclick="showTab('sentiment', event)">üòä Sentiment</div>
            <div class="tab" onclick="showTab('learning', event)">üß† Apprentissage</div>
            <div class="tab" onclick="showTab('feeds', event)">üì∞ Flux RSS</div>
            <div class="tab" onclick="showTab('themes', event)">üé® Th√®mes</div>
            <div class="tab" onclick="showTab('articles', event)">üìÑ Articles</div>
        </div>

        <!-- Onglet Analyse -->
        <div id="analysisTab" class="tab-content active">
            <div id="themeSelectorContainer"></div>
            
            <div class="dashboard">
                <div class="card">
                    <h3>üìä R√©partition par Th√®me</h3>
                    <canvas id="themeChart"></canvas>
                </div>
                <div class="card">
                    <h3>üìà √âvolution Temporelle</h3>
                    <canvas id="timelineChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Onglet Tendances -->
        <div id="trendsTab" class="tab-content">
            <div class="dashboard">
                <div class="card full-width">
                    <h3>üìà √âvolution des Th√®mes</h3>
                    <div id="trendsTable" class="trends-table">
                        <div class="loading">Calcul des tendances en cours...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Onglet M√©triques -->
        <div id="metricsTab" class="tab-content">
            <div class="dashboard">
                <div class="card full-width">
                    <h3>üéØ Statistiques Globales</h3>
                    <div class="stats-grid">
                        <div class="metric-card">
                            <strong>Total Articles :</strong> <span id="m_total">‚Äî</span>
                        </div>
                        <div class="metric-card">
                            <strong>Confiance Moyenne :</strong> <span id="m_confidence">‚Äî</span>
                        </div>
                        <div class="metric-card">
                            <strong>Fiabilit√© Bay√©sienne :</strong> <span id="m_posterior">‚Äî</span>
                        </div>
                        <div class="metric-card">
                            <strong>Corroboration Moyenne :</strong> <span id="m_corro">‚Äî</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="dashboard">
                <div class="card full-width">
                    <h3>üìà √âvolution du Sentiment (30 derniers jours)</h3>
                    <canvas id="sentimentChart"></canvas>
                </div>
            </div>

            <div class="dashboard">
                <div class="card full-width">
                    <h3>üèÜ Th√®mes Principaux</h3>
                    <ul id="topThemes" class="top-themes"></ul>
                </div>
            </div>
        </div>

        <!-- Onglet Sentiment -->
        <div id="sentimentTab" class="tab-content">
            <div class="dashboard">
                <div class="card full-width">
                    <h3>üìä Aper√ßu du Sentiment Global</h3>
                    <div id="sentimentOverview">
                        <div class="loading">Analyse de sentiment en cours...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Onglet Apprentissage -->
        <div id="learningTab" class="tab-content">
            <div class="dashboard">
                <div class="card full-width">
                    <h3>üß† Statistiques d'Apprentissage</h3>
                    <div id="learningStats">
                        <div class="loading">Chargement des statistiques...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Onglet Flux RSS -->
        <div id="feedsTab" class="tab-content">
            <div class="card">
                <h3>üìã Mes Flux RSS</h3>
                <div id="feedsList">
                    <div class="loading">Chargement des flux...</div>
                </div>
            </div>
        </div>

        <!-- Onglet Th√®mes -->
        <div id="themesTab" class="tab-content">
            <div class="card">
                <h3>üé® Mes Th√®mes</h3>
                <div id="themesList">
                    <div class="loading">Chargement des th√®mes...</div>
                </div>
            </div>
        </div>

        <!-- Onglet Articles -->
        <div id="articlesTab" class="tab-content">
            <div class="card full-width">
                <h3>üìÑ Derniers Articles</h3>
                <div id="articlesList">
                    <div class="loading">Chargement des articles...</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal Apprentissage -->
<div id="learningStatsModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h3>üìä Statistiques d'Apprentissage</h3>
        <div id="modalLearningStats">
            <div class="loading">Chargement...</div>
        </div>
    </div>
</div>

<script src="app.js"></script>
<script src="chart-manager.js"></script>
<script>
// Initialiser le ChartManager apr√®s le chargement de l'app
window.addEventListener('load', function() {
    if (window.app && window.ChartManager) {
        setTimeout(function() {
            if (!window.app.chartManager) {
                window.app.chartManager = new ChartManager(window.app);
            }
        }, 1000);
    }
});
</script>
</body>
</html>